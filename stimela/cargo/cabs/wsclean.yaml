name: wsclean
image: stimela/wsclean
command: wsclean
info: Rapid Measurement Set plotting with xarray-ms and datashader.

defaults:
  weight: "briggs 0."
  column: DATA

policies:
  positional: false
  prefix: "-"
  replace: { '_': '-' }

inputs:
  ms:
    info: Measurement set(s)
    writable: true
    dtype: MS
    required: true
    policies:
      positional: true
  prefix:
    info: Prefix of output products
    dtype: str
    alias: name
    required: true
  column:
    dtype: str
    alias: data-column
  nchan:
    info: Channels out
    dtype: int
    alias: channels-out
  j:
    info: Threads
    dtype: int
    alias: threads
  pol:
    info: Polarizations
    dtype: str
  weight:
    info: "Weightmode can be: natural, uniform, briggs. Default: uniform. When using Briggs' weighting, add the robustness parameter, like: '-weight briggs 0.5'"
    dtype: str
    policies:
      split: " "
      repeat: list
  size:
    info: Image size in pixels
    dtype: int
    required: true
    policies:
      repeat: list
      format_list: ["{size}", "{size}"]
  scale:
    info: Angular pixel size
    dtype: Union[str, float]
    required: true
  niter:
    info: Number of minor clean iterations
    dtype: int
  auto_threshold:
    dtype: float
  auto_mask:
    dtype: float
  gain:
    dtype: float
  mgain:
    dtype: float
  join_channels:
    dtype: bool
  fit_spectral_pol:
    dtype: int
  fit_beam:
    dtype: bool
  elliptical_beam:
    dtype: bool
  padding:
    dtype: float
  nwlayers:
    dtype: int
  nwlayers_factor:
    dtype: float

outputs:
  msout:
    info: Output MS
    dtype: MS
    implicit: "{self.ms}"
  dirty:
    info: Dirty images
    dtype: List[File]
    implicit: "{self.prefix}-????-dirty.fits"
  restored: 
    info: Restored images
    dtype: List[File]
    implicit: "{self.prefix}-????-image.fits"
  residual:
    dtype: List[File]
    implicit: "{self.prefix}-????-residual.fits"
  model:
    info: Model images
    dtype: List[File]
    implicit: "{self.prefix}-????-model.fits"
  restored_mfs:
    info: Restored MFS image
    dtype: File
    implicit: "{self.prefix}-MFS-image.fits"
  residual_mfs:
    info: Residual MFS image
    dtype: File
    implicit: "{self.prefix}-MFS-residual.fits"
  model_mfs:
    info: Model MFS image
    dtype: File
    implicit: "{self.prefix}-MFS-model.fits"
  dirty_mfs:
    info: Dirty MFS image
    dtype: File
    implicit: "{self.prefix}-MFS-dirty.fits"
  source_list:
    info: Source list
    dtype: File
    implicit: "{self.prefix}-source-list.txt"
